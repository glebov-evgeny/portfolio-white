import{r as C,k as z,l as Q,m as w,a as c,c as f,t as v,p as x,d as y,q as D,v as X,u as r,s as A,n as $,x as q,y as Y,z as N,g as R,b as h,w as F,j as ee,A as P,B as Z,C as E,G as M,D as j,E as W,H as te,I as oe,f as I,_ as ae}from"./entry.3cf682b1.js";const ne=decodeURIComponent,se=encodeURIComponent,ie=/; */,U=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/;function re(e,n){if(typeof e!="string")throw new TypeError("argument str must be a string");let a={},o=n||{},d=e.split(ie),l=o.decode||ne;for(let t=0;t<d.length;t++){let s=d[t],u=s.indexOf("=");if(u<0)continue;let g=s.substr(0,u).trim(),b=s.substr(++u,s.length).trim();b[0]=='"'&&(b=b.slice(1,-1)),a[g]==null&&(a[g]=le(b,l))}return a}function L(e,n,a){let o=a||{},d=o.encode||se;if(typeof d!="function")throw new TypeError("option encode is invalid");if(!U.test(e))throw new TypeError("argument name is invalid");let l=d(n);if(l&&!U.test(l))throw new TypeError("argument val is invalid");let t=e+"="+l;if(o.maxAge!=null){let s=o.maxAge-0;if(isNaN(s)||!isFinite(s))throw new TypeError("option maxAge is invalid");t+="; Max-Age="+Math.floor(s)}if(o.domain){if(!U.test(o.domain))throw new TypeError("option domain is invalid");t+="; Domain="+o.domain}if(o.path){if(!U.test(o.path))throw new TypeError("option path is invalid");t+="; Path="+o.path}if(o.expires){if(typeof o.expires.toUTCString!="function")throw new TypeError("option expires is invalid");t+="; Expires="+o.expires.toUTCString()}if(o.httpOnly&&(t+="; HttpOnly"),o.secure&&(t+="; Secure"),o.sameSite)switch(typeof o.sameSite=="string"?o.sameSite.toLowerCase():o.sameSite){case!0:t+="; SameSite=Strict";break;case"lax":t+="; SameSite=Lax";break;case"strict":t+="; SameSite=Strict";break;case"none":t+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return t}function le(e,n){try{return n(e)}catch{return e}}const de={path:"/",watch:!0,decode:e=>Q(decodeURIComponent(e)),encode:e=>encodeURIComponent(typeof e=="string"?e:JSON.stringify(e))};function G(e,n){var l;const a={...de,...n},o=ue(a)||{},d=C(o[e]??((l=a.default)==null?void 0:l.call(a)));{const t=()=>{me(e,d.value,a)};a.watch?z(d,t,{deep:a.watch!=="shallow"}):t()}return d}function ue(e={}){return re(document.cookie,e)}function ce(e,n,a={}){return n==null?L(e,n,{...a,maxAge:-1}):L(e,n,a)}function me(e,n,a={}){document.cookie=ce(e,n,a)}const pe=["for"],fe={class:"a-input__container"},_e={key:0},he=["placeholder","disabled"],ge=["type","placeholder","disabled"],H={__name:"a-input",props:{modelValue:{type:String,default:""},label:{type:String,default:""},type:{type:String,default:"text"},disabled:{type:Boolean,required:!1},placeholder:{type:String,default:""},size:{type:String,validator(e){return["large","medium","small"].indexOf(e)!==-1},default:"medium"}},emits:["update:modelValue"],setup(e,{emit:n}){const a=e,o=w(()=>({"a-input":!0,[`a-input--${a.size}`]:!0,["a-input--search"]:a.type==="search"})),d=w(()=>({[`a-input__textfield--${a.size}`]:!0,["a-input__textfield--search"]:a.type==="search"})),l=w({get(){return a.modelValue},set(t){n("update:modelValue",t)}});return(t,s)=>(c(),f("div",{class:$(["a-input",r(o)])},[e.label?(c(),f("label",{key:0,for:t.attrs.id},v(e.label),9,pe)):x("",!0),y("div",fe,[e.type=="textarea"?(c(),f("textarea",_e)):e.type=="search"?D((c(),f("input",{key:1,ref:"a-input","onUpdate:modelValue":s[0]||(s[0]=u=>A(l)?l.value=u:null),class:$(["a-input__textfield",r(d)]),type:"text",placeholder:e.placeholder,disabled:e.disabled},null,10,he)),[[X,r(l)]]):D((c(),f("input",{key:2,ref:"a-input","onUpdate:modelValue":s[1]||(s[1]=u=>A(l)?l.value=u:null),class:$(["a-input__textfield",r(d)]),type:e.type,placeholder:e.placeholder,disabled:e.disabled},null,10,ge)),[[q,r(l)]])])],2))}};const ye=["disabled","area-label"],be=["src"],we={key:1,class:"a-button__label"},O={__name:"a-button",props:{label:{type:String,default:""},disabled:{type:Boolean,required:!1},iconLink:{type:String,default:"",required:!1},block:{type:Boolean,default:!1},size:{type:String,validator(e){return["xlarge","large","medium","small"].indexOf(e)!==-1},default:"medium"},type:{type:String,validator(e){return["primary","secondary","tertiary","accent","outline","outline-grey","outline-secondary","icon"].indexOf(e)!==-1},default:"primary"},width:{type:String,default:"",required:!1}},setup(e){const n=e,a=w(()=>({[`a-button--${n.size}`]:!0,[`a-button--${n.type}`]:!0,"a-button--disabled":n.disabled,"a-button--block":n.block})),o=w(()=>n.iconLink&&n.iconLink.length);return(d,l)=>(c(),f("button",{class:$(["a-button",r(a)]),type:"button",disabled:e.disabled,style:Y([`width: ${e.width};`]),role:"button","area-label":e.label},[r(o)?(c(),f("img",{key:0,src:e.iconLink,alt:"",class:"a-button__icon"},null,8,be)):x("",!0),r(o)?x("",!0):(c(),f("span",we,v(e.label),1))],14,ye))}};const ke={class:"a-control"},ve=["type","checked","disabled"],xe={class:"a-control__container"},Se={__name:"a-control",props:{text:{type:String,default:""},typeControl:{type:String,validator(e){return["checkbox","radio"].indexOf(e)!==-1},default:"checkbox"},checked:{type:Boolean,required:!1},disabled:{type:Boolean,required:!1},modelValue:{type:Boolean,default:!1},textType:{type:String,validator(e){return["primary","contrast"].indexOf(e)!==-1},default:"primary"}},emits:["update:modelValue"],setup(e,{emit:n}){const a=e,o=w({get(){return a.modelValue},set(t){n("update:modelValue",t)}}),d=w(()=>({"a-control__trigger--checked":o.value})),l=w(()=>({[`a-control__text--${a.textType}`]:!0}));return(t,s)=>(c(),f("label",ke,[D(y("input",{"onUpdate:modelValue":s[0]||(s[0]=u=>A(o)?o.value=u:null),class:"a-control__input",type:e.typeControl,checked:e.checked,disabled:e.disabled,onChange:s[1]||(s[1]=(...u)=>t.handleChange&&t.handleChange(...u)),onClick:s[2]||(s[2]=(...u)=>t.handleClick&&t.handleClick(...u))},null,40,ve),[[q,r(o)]]),y("div",xe,[y("div",{class:$(["a-control__trigger",r(d)])},null,2),e.text||t.$slots.default?(c(),f("div",{key:0,class:$(["a-control__text",r(l)])},[N(t.$slots,"default",{},()=>[R(v(e.text),1)])],2)):x("",!0)])]))}};const $e={class:"m-form"},Ce={key:0,class:"m-form__title"},Ve={class:"m-form__checkbox"},Ue={key:1,class:"m-form__error"},J={__name:"m-form",props:{title:{type:String,default:""},error:{type:String,default:""},buttonText:{type:String,default:"Отправить"},submitDisabled:{type:Boolean,default:!0},direction:{type:String,default:"vertical"},formOptions:{type:Object,required:!1,default(){return{type:"accent"}}}},emits:["onSubmit"],setup(e,{emit:n}){const a=e,o=C(!0),d=()=>{n("onSubmit")},l=w(()=>!o.value||a.submitDisabled),t=w(()=>({[`m-form__inputs--${a.direction}`]:!0}));return(s,u)=>{const g=O,b=Se;return c(),f("div",$e,[e.title?(c(),f("div",Ce,v(e.title),1)):x("",!0),y("div",{class:$(["m-form__inputs",r(t)])},[N(s.$slots,"inputs"),h(g,{class:"m-form__button",type:e.formOptions.type,label:e.buttonText,disabled:r(l),onClick:d},null,8,["type","label","disabled"])],2),y("div",Ve,[h(b,{modelValue:r(o),"onUpdate:modelValue":u[0]||(u[0]=V=>A(o)?o.value=V:null),"text-type":e.formOptions.type},{default:F(()=>[R(v(s.$t("form.confirm")),1)]),_:1},8,["modelValue","text-type"])]),e.error?(c(),f("p",Ue,v(e.error),1)):x("",!0)])}}},K=ee({id:"user-store",state:()=>({email:"",uid:""}),actions:{setUser(e,n){this.email=e,this.uid=n}}}),Ae={class:"section-form"},Ee={class:"m-form__direction"},Be={__name:"m-form-login",emits:["onSend","formBtnClick"],setup(e,{emit:n}){const a=K(),o=P(),d=Z(),l=G("userInformation",{default:()=>[],watch:"shallow"});let t=E({email:"",password:""}),s=E({email:!0,password:!0}),u=C(!1),g=C("");const b=()=>(s.email=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/i.test(t.email),s.password=/^([A-Z,0-9][-,a-z,0-9']+[ ]*)+$/i.test(t.password)&&t.password.length>5,s.email&&s.password),V=()=>{n("formBtnClick","registration")},B=()=>{const i=new M,m=j();W(m,i).then(_=>{const p=_.user;console.log(p),console.log(p.email),a.setUser(p.email,p.uid);const k={email:p.email,id:p.uid,maxAge:60*60*24*7};l.value=k,d.push({path:"/information"}),n("onSend")}).catch(_=>{console.log(_)})};z(t,()=>{u.value=b()},{immediate:!0});async function T(){if(u)try{const{user:i}=await te(o.$auth,t.email,t.password);d.push({path:"/information"}),n("onSend"),a.setUser(i.email,i.uid);const m={email:i.email,id:i.uid,maxAge:60*60*24*7};l.value=m}catch(i){i.message==="Firebase: Error (auth/email-already-in-use)."?g.value="Пользователь уже зарегистрирован.":i.message==="Firebase: Error (auth/wrong-password)."?g.value="Неверно указан пароль.":i.message==="Firebase: Error (auth/user-not-found)."&&(g.value="Пользователь не найден.")}}return(i,m)=>{const _=H,p=J,k=O;return c(),f("section",Ae,[h(p,{"button-text":i.$t("form.login"),"submit-disabled":!r(u),error:r(g),onOnSubmit:T},{inputs:F(()=>[h(_,{id:"popup-form-email",modelValue:r(t).email,"onUpdate:modelValue":m[0]||(m[0]=S=>r(t).email=S),placeholder:i.$t("form.email")},null,8,["modelValue","placeholder"]),h(_,{id:"popup-form-password",modelValue:r(t).password,"onUpdate:modelValue":m[1]||(m[1]=S=>r(t).password=S),type:"password",placeholder:i.$t("form.password")},null,8,["modelValue","placeholder"])]),_:1},8,["button-text","submit-disabled","error"]),y("p",Ee,"- "+v(i.$t("form.or"))+" -",1),h(k,{class:"m-form__change",label:i.$t("form.registration"),onClick:V},null,8,["label"]),h(k,{class:"m-form__google",onClick:B})])}}},Te={class:"section-form"},De={class:"m-form__direction"},ze={__name:"m-form-registration",emits:["onSend","formBtnClick"],setup(e,{emit:n}){const a=K(),o=P(),d=Z(),l=G("userInformation",{default:()=>[],watch:"shallow"});let t=E({email:"",password:""}),s=E({email:!0,password:!0}),u=C(!1),g=C("");const b=()=>(s.email=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/i.test(t.email),s.password=/^([A-Z,0-9][-,a-z,0-9']+[ ]*)+$/i.test(t.password)&&t.password.length>5,s.email&&s.password),V=()=>{const i=new M,m=j();W(m,i).then(_=>{const p=_.user;console.log(p),console.log(p.email),a.setUser(p.email,p.uid);const k={email:p.email,id:p.uid,maxAge:60*60*24*7};l.value=k,d.push({path:"/information"}),n("onSend")}).catch(_=>{console.log(_)})};z(t,()=>{u.value=b()},{immediate:!0});const B=()=>{n("formBtnClick","login")};async function T(){if(u)try{const{user:i}=await oe(o.$auth,t.email,t.password);d.push({path:"/information"}),n("onSend"),a.setUser(i.email,i.uid);const m={email:i.email,id:i.uid,maxAge:60*60*24*7,SameSite:Lax};l.value=m}catch(i){i.message==="Firebase: Error (auth/email-already-in-use)."&&(g.value="Пользователь уже зарегистрирован.")}}return(i,m)=>{const _=H,p=J,k=O;return c(),f("section",Te,[h(p,{"button-text":i.$t("form.registration"),"submit-disabled":!r(u),error:r(g),onOnSubmit:T},{inputs:F(()=>[h(_,{id:"popup-form-email",modelValue:r(t).email,"onUpdate:modelValue":m[0]||(m[0]=S=>r(t).email=S),placeholder:i.$t("form.email")},null,8,["modelValue","placeholder"]),h(_,{id:"popup-form-password",modelValue:r(t).password,"onUpdate:modelValue":m[1]||(m[1]=S=>r(t).password=S),placeholder:i.$t("form.password"),type:"password"},null,8,["modelValue","placeholder"])]),_:1},8,["button-text","submit-disabled","error"]),y("p",De,"- "+v(i.$t("form.or"))+" -",1),h(k,{class:"m-form__change",label:i.$t("form.login"),onClick:B},null,8,["label"]),h(k,{class:"m-form__google",onClick:V})])}}};const Fe={class:"s-auth"},Oe={class:"container s-auth__container container__box"},Ie={class:"s-auth__aside container__aside"},Le={class:"s-auth__title s-title"},qe={class:"s-auth__main container__main"},Ne={__name:"s-auth",setup(e){let n=C("login");const a=o=>{n.value=o};return(o,d)=>{const l=Be,t=ze;return c(),f("section",Fe,[y("div",Oe,[y("div",Ie,[y("h2",Le,v(r(n)==="login"?o.$t("login"):o.$t("registration")),1)]),y("div",qe,[r(n)==="login"?(c(),I(l,{key:0,onFormBtnClick:a})):x("",!0),r(n)==="registration"?(c(),I(t,{key:1,onFormBtnClick:a})):x("",!0)])])])}}},Re={},Pe={class:"s-main"};function Ze(e,n){const a=Ne;return c(),f("main",Pe,[h(a)])}const je=ae(Re,[["render",Ze]]);export{je as default};
